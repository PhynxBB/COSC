#Linux Auditing and Logging

Log Types
---
Authentication
    /var/log/auth.log - Authentication related events
    /var/run/utmp - Users currently logged in
    /var/log/wtmp - History file for utmp
    /var/log/btmp - Failed login attempts

Application
    apache - Web Server (dir)
    apt - Package Manager (dir)
    /var/log/mysql.log

System
    /var/log/messages - Legacy catch all
    /var/log/syslog - Ubuntu/Debian catch all
    dmesg - Device messenger (queries /proc/kmsg)
       - Kernel Ring Buffer - Never fills
       - First logs generated by the system

Takeaways
    Location: /var/log
    Config File: /etc/rsyslog.conf
    Service: /usr/sbin/rsyslogd


Useful Logging Commands
    tail -f - Continuously show end of file
    logger - Send a user generated message to system log
    > /var/log/messages - Wipes logs
    last -f /var/log{wtmp,btmp} - Needed to view data files

Logrotate
    Unix Utility
    Rotates logs
    WHOLELOTTARED

cat conn.log | jq '. | {"resp_ip_bytes"}' | awk '{print $2}' | awk -v min=41 '$1>min' | wc -l
